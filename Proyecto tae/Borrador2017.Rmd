---
title: "Untitled"
author: "Edwin Caicedo"
date: "23 de febrero de 2018"
output: html_document
---
```{r}
library(rgdal)
library(leaflet)
library(raster)
```


```{r}
Base3 <- shapefile("Accidentalidad_2017.shp",encoding="UTF-8",use_iconv=TRUE)
```

Filtrado de Base
```{r}
Base <- subset(Base3, Base3@data$CLASE=="Incendio")
```

```{r}
#Paleta de colores
unique(Base$CLASE)
pal <-colorFactor(palette=rainbow(8),levels=unique(Base$CLASE),ordered=F)

cbind(rainbow(8),unique(Base$CLASE))

popup<-paste(Base$CLASE,Base$BARRIO,sep="<br/>")


m<-leaflet()
m<-fitBounds(m, lng1=min(Base@coords[,1]), 
             lat1=min(Base@coords[,2]), 
             lng2=max(Base@coords[,1]),
             lat2=max(Base@coords[,2]))
m<-addProviderTiles(m,provider="OpenStreetMap.Mapnik")
m<-addCircleMarkers(m,
                    lng = Base@coords[,1],
                     lat = Base@coords[,2],
                     popup = popup, 
                     radius = 4, 
                     stroke = FALSE,
                    color=pal(Base$CLASE),
                     fillOpacity = 0.75
                     )
m<-addLegend(m,"topright",pal=pal,values=Base@data$CLASE, 
             title="Tipo de accidente",
             labels = Base@data$CLASE,opacity = 1)

m
```